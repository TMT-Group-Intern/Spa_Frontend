<div class="flex flex-row bg-gray-200 h-full">
  <div class="basis-1/4 border p-4 rounded-10 bg-white">
    <tds-table
      class="table-vertical-line"
      [listData]="listSpaServiceQueue"
      [showPagination]="false"
    >
      <thead>
        <tr>
          <th>Họ Tên Khách Hàng</th>
          <th>Trạng Thái</th>
        </tr>
      </thead>
      <tbody>
        <!-- <ng-template *ngFor="let data of listSpaServiceQueue"> -->
        <tr
          *ngFor="let data of listSpaServiceQueue"
          (click)="renderCustomerDetail(data)"
        >
          <td>{{ data.Customer.FirstName + ' ' + data.Customer.LastName }}</td>
          <td>
            <select
              name="status"
              class=""
              (change)="onStatusChange($event, data.AppointmentID)"
            >
              <option value="In_progress">Đang tiến hành</option>
              <option value="Completed">Hoàn thành</option>
            </select>
            <!-- <select name="status" class="">
              <option
                value="none conplete"
                (click)="
                  updateStatus(
                    appointmentAllInfo.appointmentAllInfo,
                    'completed'
                  )
                "
              >
                Đang tiến hành
              </option>
              <option value="completed">Hoàn thành</option>
            </select> -->
          </td>
          <!-- <td>{{ data.TeachnicalStaff }}</td>
          <td>{{ data.EmployeeCode }}</td> -->
        </tr>
        <!-- </ng-template> -->
      </tbody>
    </tds-table>
  </div>
  <!-- //////////bên phải /////////// -->
  <div
    class="basis-3/4 border p-4 rounded-10 bg-white ml-4"
    *ngIf="appointmentAllInfo !== null && checkActive === true; else elseBlock"
  >
    <div class="flex flex-row">
      <!-- Left section with image -->
      <div class="w-1/4">
        <img
          src="https://mir-s3-cdn-cf.behance.net/project_modules/1400_opt_1/d07bca98931623.5ee79b6a8fa55.jpg"
          alt="Customer Image"
          class="w-full rounded-lg"
        />
      </div>
      <!-- Right section with customer details -->
      <div class="w-3/4 ml-5 text-lg">
        <div class="font-medium mb-2">
          Họ và Tên:
          <span class="font-normal">{{
            appointmentAllInfo.Customer.FirstName +
              ' ' +
              appointmentAllInfo.Customer.LastName
          }}</span>
        </div>
        <div class="font-medium mb-4">
          Dịch vụ đã chọn:
          <span *ngFor="let service of customerDetail; let first = first">
            {{ (first ? '' : ', ') + service.ServiceName }}
          </span>
        </div>

        <!-- Bottom section with file upload and buttons -->
        <div class="flex flex-row">
          <!-- Left side with file upload and upload button -->
          <div class="w-full">
            <div class="flex flex-row items-center">
              <input
                type="file"
                (change)="onFileSelected($event)"
                class="mr-2 mb-5"
                multiple
              />
              <button
                class="rounded-full bg-green-300 py-1 px-2"
                (click)="uploadImage(appointmentAllInfo.AppointmentID)"
              >
                Upload Photo
              </button>
            </div>
          </div>
        </div>

        <!-- Right side with history button -->
        <div class="w-1/2">
          <button
            (click)="callModalHistory()"
            class="rounded-full bg-green-300 py-1 px-2"
          >
            History Customer
          </button>
        </div>
      </div>
    </div>

    <!-- Table section -->
    <table class="table-fixed border-collapse w-full mt-4">
      <thead>
        <tr>
          <th class="border border-gray-400 px-4 py-2">Service</th>
          <th class="border border-gray-400 px-4 py-2">Complete</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let service of customerDetail">
          <td class="border border-gray-400 px-4 py-2 text-center">
            {{ service.ServiceName }}
          </td>
          <td class="border border-gray-400 px-4 py-2 text-center">
            <input
              type="checkbox"
              [checked]="checkboxStatess[service.ServiceID]"
              (change)="toggleCheckbox(service.ServiceID)"
              class="form-checkbox h-5 w-5 text-green-500"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Footer buttons -->
    <div class="flex gap-4 justify-center mt-4">
      <button
        class="rounded-full bg-blue-500 text-white py-2 px-4 hover:bg-blue-600"
        (click)="onSave(appointmentAllInfo, checkboxStatess)"
      >
        Lưu
      </button>
      <button
        class="rounded-full bg-gray-300 text-gray-800 py-2 px-4 hover:bg-gray-400"
      >
        Hủy
      </button>
    </div>
  </div>
  <ng-template #elseBlock class="basis-3/4 border p-4 rounded-10 bg-white ml-4">
    <div class="w-full flex items-center justify-center">
      <p class="text-2xl">Vui lòng chọn khách hàng để khám</p>
    </div>
  </ng-template>
</div>
